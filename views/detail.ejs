<!doctype html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <title>Hello, world!</title>
  <style>
    .btn {
      float: right;
      margin-right: 5px;
      white-space: nowrap;
    }

    .board-title {
      float: left;
      border-bottom: none;
      width: 200px;
    }

    .c_date {
      white-space: nowrap;
      width: 200px;

    }

    td {
      padding-bottom: 10px;
    }

    .board-date {
      float: right;
      width: 200px;
      z-index: 0;
    }
  </style>
</head>

<body>
  <%- include('nav.ejs') %>
    <div class="container mt-4">
      <h4 class="text-center">상세페이지</h4>

      <table class="table table-striped">
        <thead>
          <tr>
            <td class="board-title">
              제목 : <%=board.title%>
            </td>
          </tr>
          <tr>
            <td class="board-author">
              작성자 : <%=board.author%>
            </td>
            <td class="board-date">
              <%=board.board_date%>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr class="">
            <td colspan="4">
              <%=board.contents%>
            </td>
          </tr>
          <tr>
            <td colspan="4" class="btn-section">
              <button class="btn btn-danger delete" data-id="<%= board._id %>">삭제</button>
              <button class="btn btn-success edit" data-id="<%= board._id %>">수정</button>
              <!--수정 버튼을 누르면 board._id 를 get 해옴, 버튼이 있던 board에 있는 id를 이용해 write.ejs에 id를 넣어 edit.던fmf aksemfdjdha-->
            </td>
          </tr>
        </tbody>

      </table>
    </div>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"></script>

    <script>
$('.edit').click(function (e) {
        let 글번호 = e.target.dataset.id;
        //글번호는 click을 실행한 버튼의(e) target이용해 dataset id를 추출

        $.ajax({
          method: 'get',
          url: '/edit/' + 글번호
        }).done(function (결과) {
          location.href = '/edit/' + 글번호;})
        .fail(function (a, b, c) {
          //오류, 실패시 띄울 함수인데 비어있네

        });

      })


$('.delete').click(function (e) {
        let 글번호 = e.target.dataset.id;
        //글번호는 click을 실행한 버튼의(e) target이용해 dataset id를 추출

        $.ajax({
          method: 'get',
          url: '/index',
        })
        .done(function (결과) {
          location.href = '/index';})
        .fail(function (a, b, c) {
          //오류, 실패시 띄울 함수인데 비어있네

        })

      })
    
    </script>
</body>

</html>